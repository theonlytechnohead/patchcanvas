import{S as b,i as k,s as C,a as y,e as f,c as w,b as F,d as _,f as S,m as $,t as l,g as i,h as g,j as v,k as d,n as p,u as q,v as x,w as P,x as j,C as U,l as u,p as m,y as W}from"./Canvas-CK9pAYse.js";function h(c){let n,o;return n=new U({}),{c(){w(n.$$.fragment)},m(e,t){$(n,e,t),o=!0},i(e){o||(l(n.$$.fragment,e),o=!0)},o(e){i(n.$$.fragment,e),o=!1},d(e){v(n,e)}}}function B(c){let n,o,e=c[0]&&h();return{c(){e&&e.c(),n=x()},m(t,a){e&&e.m(t,a),_(t,n,a),o=!0},p(t,a){t[0]?e?a&1&&l(e,1):(e=h(),e.c(),l(e,1),e.m(n.parentNode,n)):e&&(P(),i(e,1,1,()=>{e=null}),j())},i(t){o||(l(e),o=!0)},o(t){i(e),o=!1},d(t){t&&g(n),e&&e.d(t)}}}function E(c){let n,o,e,t;return e=new y({props:{$$slots:{default:[B]},$$scope:{ctx:c}}}),{c(){n=f("main"),o=f("div"),w(e.$$.fragment),F(o,"height","100%")},m(a,s){_(a,n,s),S(n,o),$(e,o,null),t=!0},p(a,[s]){const r={};s&9&&(r.$$scope={dirty:s,ctx:a}),e.$set(r)},i(a){t||(l(e.$$.fragment,a),t=!0)},o(a){i(e.$$.fragment,a),t=!1},d(a){a&&g(n),v(e)}}}function L(c,n,o){let e,t;d(c,u,s=>o(1,e=s)),d(c,p,s=>o(2,t=s)),p.set("wpbc");let a=!1;return q(()=>{if(t==="wpbc"&&!a){const s=new URLSearchParams(window.location.search).get("canvas");s!==null&&typeof s=="string"&&0<s.length?(console.log("Fetching",`${s}...`),fetch(`https://anderserver.ddns.net/patchcanvas/wpbc/${s}.patch`).then(r=>r.json()).then(r=>{if(console.log("Fetched requested canvas, updating..."),m(u,e=structuredClone(r),e),r.mode!==t)throw new Error(`Fetched a save with an incorrect mode!
Wanted: ${t}, fetched: ${r.mode}`);W().then(()=>m(u,e.updated=!0,e)).then(()=>o(0,a=!0)).then(()=>console.log("Update complete!"))}).catch(r=>{console.log("Couldn't fetch requested canvas:",r),window.location.pathname="/",window.location.search=""})):window.location.pathname="/"}}),[a]}class M extends b{constructor(n){super(),k(this,n,L,E,C,{})}}new M({target:document.body});
